.\\" auto-generated by docbook2man-spec $Revision: 1.1.1.1 $
.TH "PG_CTL" "1" "2009-06-27" "Application" "PostgreSQL Server Applications"
.SH NAME
pg_ctl \- start, stop, or restart a PostgreSQL server

.SH SYNOPSIS
.sp
\fBpg_ctl\fR \fBstart\fR [ \fB-w\fR ]  [ \fB-t \fIseconds\fB\fR ]  [ \fB-s\fR ]  [ \fB-D \fIdatadir\fB\fR ]  [ \fB-l \fIfilename\fB\fR ]  [ \fB-o \fIoptions\fB\fR ]  [ \fB-p \fIpath\fB\fR ]  [ \fB-c\fR ] 

\fBpg_ctl\fR \fBstop\fR [ \fB-W\fR ]  [ \fB-t \fIseconds\fB\fR ]  [ \fB-s\fR ]  [ \fB-D \fIdatadir\fB\fR ]  [ \fB-m
  [ s[mart] ]  [ f[ast] ]  [ i[mmediate] ] 
\fR ] 

\fBpg_ctl\fR \fBrestart\fR [ \fB-w\fR ]  [ \fB-t \fIseconds\fB\fR ]  [ \fB-s\fR ]  [ \fB-D \fIdatadir\fB\fR ]  [ \fB-c\fR ]  [ \fB-m
  [ s[mart] ]  [ f[ast] ]  [ i[mmediate] ] 
\fR ]  [ \fB-o \fIoptions\fB\fR ] 

\fBpg_ctl\fR \fBreload\fR [ \fB-s\fR ]  [ \fB-D \fIdatadir\fB\fR ] 

\fBpg_ctl\fR \fBstatus\fR [ \fB-D \fIdatadir\fB\fR ] 

\fBpg_ctl\fR \fBkill\fR [ \fB\fIsignal_name\fB\fR ]  [ \fB\fIprocess_id\fB\fR ] 

\fBpg_ctl\fR \fBregister\fR [ \fB-N \fIservicename\fB\fR ]  [ \fB-U \fIusername\fB\fR ]  [ \fB-P \fIpassword\fB\fR ]  [ \fB-D \fIdatadir\fB\fR ]  [ \fB-w\fR ]  [ \fB-t \fIseconds\fB\fR ]  [ \fB-o \fIoptions\fB\fR ] 

\fBpg_ctl\fR \fBunregister\fR [ \fB-N \fIservicename\fB\fR ] 
.SH "DESCRIPTION"
.PP
\fBpg_ctl\fR is a utility for starting,
stopping, or restarting the PostgreSQL
backend server (\fBpostgres\fR(1)), or displaying the
status of a running server. Although the server can be started
manually, \fBpg_ctl\fR encapsulates tasks such
as redirecting log output and properly detaching from the terminal
and process group. It also provides convenient options for
controlled shutdown.
.PP
In \fBstart\fR mode, a new server is launched. The
server is started in the background, and standard input is attached to
\fI/dev/null\fR. The standard output and standard
error are either appended to a log file (if the \fB-l\fR
option is used), or redirected to \fBpg_ctl\fR's 
standard output (not standard error). If no log file is chosen, the 
standard output of \fBpg_ctl\fR should be redirected 
to a file or piped to another process such as a log rotating program
like \fBrotatelogs\fR; otherwise \fBpostgres\fR 
will write its output to the controlling terminal (from the background) 
and will not leave the shell's process group.
.PP
In \fBstop\fR mode, the server that is running in
the specified data directory is shut down. Three different
shutdown methods can be selected with the \fB-m\fR
option: ``Smart'' mode waits for online backup mode
to finish and all the clients to disconnect. This is the default.
``Fast'' mode does not wait for clients to disconnect and
will terminate an online backup in progress. All active transactions are
rolled back and clients are forcibly disconnected, then the
server is shut down. ``Immediate'' mode will abort
all server processes without a clean shutdown. This will lead to 
a recovery run on restart.
.PP
\fBrestart\fR mode effectively executes a stop followed
by a start. This allows changing the \fBpostgres\fR
command-line options.
.PP
\fBreload\fR mode simply sends the
\fBpostgres\fR process a \fBSIGHUP\fR
signal, causing it to reread its configuration files
(\fIpostgresql.conf\fR,
\fIpg_hba.conf\fR, etc.). This allows changing of
configuration-file options that do not require a complete restart
to take effect.
.PP
\fBstatus\fR mode checks whether a server is running in
the specified data directory. If it is, the PID
and the command line options that were used to invoke it are
displayed.
.PP
\fBkill\fR mode allows you to send a signal to a specified
process. This is particularly valuable for Microsoft Windows
which does not have a \fBkill\fR command. Use 
--help to see a list of supported signal names.
.PP
\fBregister\fR mode allows you to register a system service
on Microsoft Windows.
.PP
\fBunregister\fR mode allows you to unregister a system service
on Microsoft Windows, previously registered with the
\fBregister\fR command.
.SH "OPTIONS"
.TP
\fB-c\fR
Attempt to allow server crashes to produce core files, on platforms
where this available, by lifting any soft resource limit placed on 
them. 
This is useful in debugging or diagnosing problems by allowing a 
stack trace to be obtained from a failed server process.
.TP
\fB-D \fIdatadir\fB\fR
Specifies the file system location of the database files. If
this is omitted, the environment variable
\fBPGDATA\fR is used.
.TP
\fB-l \fIfilename\fB\fR
Append the server log output to
\fIfilename\fR. If the file does not
exist, it is created. The \fBumask\fR is set to 077, so access to
the log file from other users is disallowed by default.
.TP
\fB-m \fImode\fB\fR
Specifies the shutdown mode. \fImode\fR
can be smart, fast, or
immediate, or the first letter of one of
these three.
.TP
\fB-o \fIoptions\fB\fR
Specifies options to be passed directly to the
\fBpostgres\fR command.

The options are usually surrounded by single or double
quotes to ensure that they are passed through as a group.
.TP
\fB-p \fIpath\fB\fR
Specifies the location of the \fIpostgres\fR
executable. By default the \fIpostgres\fR executable is taken from the same
directory as \fBpg_ctl\fR, or failing that, the hard-wired
installation directory. It is not necessary to use this
option unless you are doing something unusual and get errors
that the \fIpostgres\fR executable was not found.
.TP
\fB-s\fR
Only print errors, no informational messages.
.TP
\fB-t\fR
The number of seconds to wait when waiting for start or shutdown
to complete.
.TP
\fB-w\fR
Wait for the start or shutdown to complete. The default wait time
is 60 seconds. This is the default option for shutdowns. A successful 
shutdown is indicated by removal of the PID 
file. For starting up, a successful \fBpsql -l\fR 
indicates success. \fBpg_ctl\fR will attempt to 
use the proper port for \fBpsql\fR. If the environment variable 
\fBPGPORT\fR exists, that is used. Otherwise, it will see if a port 
has been set in the \fIpostgresql.conf\fR file. 
If neither of those is used, it will use the default port that 
PostgreSQL was compiled with 
(5432 by default). When waiting, \fBpg_ctl\fR will
return an accurate exit code based on the success of the startup 
or shutdown.
.TP
\fB-W\fR
Do not wait for start or shutdown to complete. This is the
default for starts and restarts.
.SS "OPTIONS FOR WINDOWS"
.TP
\fB-N \fIservicename\fB\fR
Name of the system service to register. The name will be used
as both the service name and the display name.
.TP
\fB-P \fIpassword\fB\fR
Password for the user to start the service.
.TP
\fB-U \fIusername\fB\fR
User name for the user to start the service. For domain users, use the
format DOMAIN\\username.
.SH "ENVIRONMENT"
.TP
\fBPGDATA\fR
Default data directory location.
.TP
\fBPGPORT\fR
Default port for \fBpsql\fR(1) (used by the -w option).
.PP
For additional server variables, see \fBpostgres\fR(1).
This utility, like most other PostgreSQL utilities,
also uses the environment variables supported by \fBlibpq\fR
(see in the documentation).
.PP
.SH "FILES"
.TP
\fB\fIpostmaster.pid\fB\fR
The existence of this file in the data directory is used to help
\fBpg_ctl\fR determine if the server is
currently running or not.
.TP
\fB\fIpostmaster.opts\fB\fR
If this file exists in the data directory,
\fBpg_ctl\fR (in \fBrestart\fR mode) 
will pass the contents of the file as options to
\fBpostgres\fR, unless overridden 
by the \fB-o\fR option. The contents of this file 
are also displayed in \fBstatus\fR mode.
.TP
\fB\fIpostgresql.conf\fB\fR
This file, located in the data directory, is parsed to find the
proper port to use with \fBpsql\fR when the
\fB-w\fR is given in \fBstart\fR mode.
.SH "NOTES"
.PP
Waiting for complete start is not a well-defined operation and might
fail if access control is set up so that a local client cannot
connect without manual interaction (e.g., password authentication). For
additional connection variables, see in the documentation,
and for passwords, also see in the documentation.
.SH "EXAMPLES"
.SS "STARTING THE SERVER"
.PP
To start up a server:
.sp
.nf
$ \fBpg_ctl start\fR
.sp
.fi
.PP
An example of starting the server, blocking until the server has
come up is:
.sp
.nf
$ \fBpg_ctl -w start\fR
.sp
.fi
.PP
For a server using port 5433, and
running without \fBfsync\fR, use:
.sp
.nf
$ \fBpg_ctl -o "-F -p 5433" start\fR
.sp
.fi
.SS "STOPPING THE SERVER"
.PP
.sp
.nf
$ \fBpg_ctl stop\fR
.sp
.fi
stops the server. Using the \fB-m\fR switch allows one
to control \fBhow\fR the backend shuts down.
.SS "RESTARTING THE SERVER"
.PP
Restarting the server is almost equivalent to stopping the
server and starting it again
except that \fBpg_ctl\fR saves and reuses the command line options that
were passed to the previously running instance. To restart
the server in the simplest form, use:
.sp
.nf
$ \fBpg_ctl restart\fR
.sp
.fi
.PP
To restart server,
waiting for it to shut down and to come up:
.sp
.nf
$ \fBpg_ctl -w restart\fR
.sp
.fi
.PP
To restart using port 5433 and disabling \fBfsync\fR after restarting:
.sp
.nf
$ \fBpg_ctl -o "-F -p 5433" restart\fR
.sp
.fi
.SS "SHOWING THE SERVER STATUS"
.PP
Here is a sample status output from
\fBpg_ctl\fR:
.sp
.nf
$ \fBpg_ctl status\fR
pg_ctl: server is running (pid: 13718)
Command line was:
/usr/local/pgsql/bin/postgres '-D' '/usr/local/pgsql/data' '-p' '5433' '-B' '128'
.sp
.fi
This is the command line that would be invoked in restart mode.
.SH "SEE ALSO"
.PP
\fBpostgres\fR(1)
